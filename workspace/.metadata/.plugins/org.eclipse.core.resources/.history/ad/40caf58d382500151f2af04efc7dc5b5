# /usr/bin/python
# encoding=utf8

from atbtools.header import * 
from atbtools.mysqlTools import *
from atbtools.computeTools import *
from atbtools.paymentTools import *
from math import floor
import time
import sys

if __name__ == '__main__':
    #判断是增量还是全量
    if (len(sys.argv) <= 1):
        print "'divideId'程序必须指定对应的表格名称."
        exit(1)
    else:
        table_name = str(sys.argv[1])
    conn_db = getConn(DBHOST, USERNAME, PASSWORD, DB, PORT)
    cur_db = getCursors(conn_db)
    initializeCursors(cur_db)
    for _date in TIMESTAMP_LIST:
        print _date
        stringSQL = "SELECT id, date, site_id, borrower, borrowing_amount, loan_period, annulized_rating, payment_method, investor, release_time, end_time FROM " + srcdb_info
    stringSQL = stringSQL + " WHERE `site_id` in ('" + "','".join(platform_id_list) + "')"
    print "正在从数据库传输数据回本地..."